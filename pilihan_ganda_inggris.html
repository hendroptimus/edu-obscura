<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SOAL PILIHAN GANDA UTS BAHASA INGGRIS</title>
    <style>
        :root {
            --primary-color: #4a6fa5;
            --secondary-color: #166088;
            --accent-color: #4fc3f7;
            --background-color: #f5f7fa;
            --text-color: #333;
            --correct-color: #4caf50;
            --wrong-color: #f44336;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: var(--background-color);
            color: var(--text-color);
            margin: 0;
            padding: 20px;
            line-height: 1.6;
        }
        
        .container {
            max-width: 800px;
            margin: 0 auto;
            background: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }
        
        h1 {
            color: var(--primary-color);
            text-align: center;
            margin-bottom: 30px;
        }
        
        .participant-section {
            margin-bottom: 20px;
            padding: 15px;
            background-color: #f0f8ff;
            border-radius: 8px;
        }
        
        label {
            display: block;
            margin-bottom: 8px;
            font-weight: bold;
            color: var(--secondary-color);
        }
        
        select {
            width: 100%;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 5px;
            font-size: 16px;
        }
        
        .quiz-container {
            display: none;
        }
        
        .question-slide {
            display: none;
            padding: 20px;
            background-color: white;
            border-radius: 8px;
            margin-bottom: 20px;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
        }
        
        .question-slide.active {
            display: block;
            animation: fadeIn 0.5s;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        
        .question-number {
            font-size: 18px;
            font-weight: bold;
            color: var(--secondary-color);
            margin-bottom: 10px;
        }
        
        .question-text {
            font-size: 16px;
            margin-bottom: 20px;
            line-height: 1.5;
        }
        
        .options {
            margin-bottom: 20px;
        }
        
        .option {
            display: block;
            margin-bottom: 10px;
            padding: 12px 15px;
            background-color: #f8f9fa;
            border: 1px solid #ddd;
            border-radius: 5px;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .option:hover {
            background-color: #e9ecef;
            border-color: var(--accent-color);
        }
        
        .option.selected {
            background-color: var(--accent-color);
            color: white;
            border-color: var(--secondary-color);
        }
        
        .option.correct {
            background-color: var(--correct-color);
            color: white;
        }
        
        .option.wrong {
            background-color: var(--wrong-color);
            color: white;
        }
        
        .navigation {
            display: flex;
            justify-content: space-between;
            margin-top: 20px;
        }
        
        button {
            padding: 10px 20px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
            transition: all 0.3s;
        }
        
        button:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }
        
        .prev-btn {
            background-color: #6c757d;
            color: white;
        }
        
        .next-btn, .submit-btn {
            background-color: var(--primary-color);
            color: white;
        }
        
        .prev-btn:hover, .next-btn:hover, .submit-btn:hover {
            opacity: 0.9;
        }
        
        .menu-btn {
            background-color: #6c757d;
            color: white;
            margin-top: 20px;
        }
        
        .progress-container {
            width: 100%;
            background-color: #e0e0e0;
            border-radius: 5px;
            margin-bottom: 20px;
        }
        
        .progress-bar {
            height: 10px;
            background-color: var(--primary-color);
            border-radius: 5px;
            width: 0%;
            transition: width 0.3s;
        }
        
        .thank-you {
            text-align: center;
            display: none;
            padding: 30px;
        }
        
        .thank-you h2 {
            color: var(--primary-color);
            margin-bottom: 20px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>SOAL PILIHAN GANDA UTS BAHASA INGGRIS</h1>
        <h1>XI ULW 1</h1>
        <div class="participant-section" id="participant-section">
            <label for="participant">Select Your Name:</label>
            <select id="participant">
                <option value="" disabled selected>Pilih nama lengkap</option>
                <option value="ALIF FAOZIN">ALIF FAOZIN</option>
                <option value="ANDY LIE NARDY">ANDY LIE NARDY</option>
                <option value="APRILIA PUTRI HALIM">APRILIA PUTRI HALIM</option>
                <option value="AULIA SEPTIA AZZAHRAH RAMADHANI">AULIA SEPTIA AZZAHRAH RAMADHANI</option>
                <option value="BEREKHYA WILLSE PETRUCCI">BEREKHYA WILLSE PETRUCCI</option>
                <option value="CHIESSA RAMADHAN AULI">CHIESSA RAMADHAN AULI</option>
                <option value="DHEA SHARAPOVA">DHEA SHARAPOVA</option>
                <option value="DIKA PRATAMA">DIKA PRATAMA</option>
                <option value="DIMAS SUSANTO">DIMAS SUSANTO</option>
                <option value="EUGENIA VALENDRIANI WONGSO">EUGENIA VALENDRIANI WONGSO</option>
                <option value="GABRIEL ABDILLAH">GABRIEL ABDILLAH</option>
                <option value="HUTARI AWADINA">HUTARI AWADINA</option>
                <option value="IBAM ADITHYA">IBAM ADITHYA</option>
                <option value="IHSAN">IHSAN</option>
                <option value="IRA SENHA">IRA SENHA</option>
                <option value="IRZA GUNAWAN">IRZA GUNAWAN</option>
                <option value="JESSELYN PRISCELLA">JESSELYN PRISCELLA</option>
                <option value="KALORIN">KALORIN</option>
                <option value="KEISYA RASTIARA KIRANA">KEISYA RASTIARA KIRANA</option>
                <option value="LADIES SALSABILAH">LADIES SALSABILAH</option>
                <option value="LILIAN">LILIAN</option>
                <option value="MARCHEL SAPUTRA JAYA">MARCHEL SAPUTRA JAYA</option>
                <option value="MUFTHI ZASKIA HASIBUAN">MUFTHI ZASKIA HASIBUAN</option>
                <option value="NABIL FEBRYATAMA">NABIL FEBRYATAMA</option>
                <option value="PINA PUSPITA">PINA PUSPITA</option>
                <option value="REHAN">REHAN</option>
                <option value="RIZAL">RIZAL</option>
                <option value="RIZKY PAMUNGKAS">RIZKY PAMUNGKAS</option>
                <option value="SYINDI">SYINDI</option>
                <option value="VIKI SRICAHYANTI">VIKI SRICAHYANTI</option>
                <option value="VISYA INDRIANI">VISYA INDRIANI</option>
                <option value="WITRA">WITRA</option>
                <option value="ZHAVINA CHAILA AL ZAHRA">ZHAVINA CHAILA AL ZAHRA</option>
                <option value="ZIDAN RIZQULLAH PITOYO">ZIDAN RIZQULLAH PITOYO</option>
            </select>
            <button id="start-quiz" style="margin-top: 15px; width: 100%;">Start Quiz</button>
        </div>
        
        <div class="quiz-container" id="quiz-container">
            <div class="progress-container">
                <div class="progress-bar" id="progress-bar"></div>
            </div>
            
            <div id="question-container">
                <!-- Questions will be inserted here by JavaScript -->
            </div>
            
            <div class="navigation">
                <button class="prev-btn" id="prev-btn" disabled>Previous</button>
                <button class="next-btn" id="next-btn">Next</button>
                <button class="submit-btn" id="submit-btn" style="display: none;">Submit Quiz</button>
            </div>
        </div>
        
        <div class="thank-you" id="thank-you">
            <h2>Thank You!</h2>
            <p>Your answers have been submitted successfully.</p>
            <button class="menu-btn" id="menu-btn">Back to Menu</button>
        </div>
    </div>

    <script>
        const questions = [
            {
                question: "1. Last weekend, we ___ to Borobudur Temple with our classmates.",
                options: ["A. go", "B. goes", "C. went", "D. gone"],
                answer: 2
            },
            {
                question: "2. The tour guide ___ us about the history of the monument.",
                options: ["A. tells", "B. told", "C. telling", "D. tell"],
                answer: 1
            },
            {
                question: "3. After visiting the museum, we ___ lunch at a local restaurant.",
                options: ["A. eat", "B. ate", "C. eaten", "D. eats"],
                answer: 1
            },
            {
                question: "4. Tourist: Where did you go yesterday? Guide: We ___ to Tanjung Tinggi Beach.",
                options: ["A. go", "B. gone", "C. went", "D. going"],
                answer: 2
            },
            {
                question: "5. Tourist: Did you enjoy the trip? Traveler: Yes! I really ___ the boat tour around the island.",
                options: ["A. enjoy", "B. enjoyed", "C. enjoying", "D. enjoys"],
                answer: 1
            },
            {
                question: "6. Tourist: What time did the show start? Staff: It ___ at 7 PM.",
                options: ["A. starts", "B. starting", "C. start", "D. started"],
                answer: 3
            },
            {
                question: "7. He helps tourists during their trip and explains about tourist destinations. What is his job?",
                options: ["A. Tour guide", "B. Chef", "C. Pilot", "D. Bellboy"],
                answer: 0
            },
            {
                question: "8. She serves food and drinks in a restaurant. Who is she?",
                options: ["A. Driver", "B. Waitress", "C. Receptionist", "D. Manager"],
                answer: 1
            },
            {
                question: "9. He flies an airplane. What is his profession?",
                options: ["A. Sailor", "B. Mechanic", "C. Pilot", "D. Travel agent"],
                answer: 2
            },
            {
                question: "10. What does a receptionist do?",
                options: [
                    "A. Welcome guests and answer phone calls",
                    "B. Serve food",
                    "C. Clean the room",
                    "D. Fly a plane"
                ],
                answer: 0
            },
            {
                question: "11. What does a tour guide do?",
                options: [
                    "A. Drive the bus",
                    "B. Guide and give information to tourists",
                    "C. Cook meals in the kitchen",
                    "D. Clean the hotel rooms"
                ],
                answer: 1
            },
            {
                question: "12. What does a travel agent do?",
                options: [
                    "A. Take photos of tourists",
                    "B. Provide tour and ticketing services",
                    "C. Fly the airplane",
                    "D. Guard the museum"
                ],
                answer: 1
            },
            {
                question: "13. The tourists got wet because they didn't bring an umbrella. What is the cause?",
                options: [
                    "A. The weather was sunny",
                    "B. The tourists brought umbrellas",
                    "C. It was rainy",
                    "D. They stayed in the hotel"
                ],
                answer: 2
            },
            {
                question: "14. The flight was delayed because of bad weather. What is the cause?",
                options: [
                    "A. The machine had a trouble",
                    "B. It was strong wind and cloudy",
                    "C. The airport was empty",
                    "D. The pilot arrived late"
                ],
                answer: 1
            },
            {
                question: "15. The guide arrived late, so the tour started at 10 AM. What is the effect?",
                options: [
                    "A. The guide was early",
                    "B. The weather so bad",
                    "C. The tourists canceled the tour",
                    "D. The trip schedule was delayed"
                ],
                answer: 3
            },
            {
                question: "16. The museum was closed, so the tourists visited the beach instead. What does it mean?",
                options: [
                    "A. The visiting schedule was changed",
                    "B. The tourists stayed in the hotel",
                    "C. The museum was very crowded",
                    "D. The guide rejected to visit the museum"
                ],
                answer: 0
            },
            {
                question: "17. What is the function of a hotel voucher in a pick-up service?",
                options: [
                    "A. To confirm the guest's reservation and room",
                    "B. To book the flight",
                    "C. To carry the guest's luggage",
                    "D. To show the guest's identity"
                ],
                answer: 0
            },
            {
                question: "18. The driver held a signboard with the guest's name. What is the signboard for?",
                options: [
                    "A. To carry luggage",
                    "B. To show the guest's name",
                    "C. To protect the guest",
                    "D. To book the hotel"
                ],
                answer: 1
            },
            {
                question: "19. The guest used a trolley at the airport. What is the function of a trolley?",
                options: [
                    "A. To check tickets",
                    "B. To show guest identity",
                    "C. To carry luggage easily",
                    "D. To book flights"
                ],
                answer: 2
            },
            {
                question: "20. A uniform helps the guest identify the staff. What is the function of a uniform in pick-up service?",
                options: [
                    "A. To help guests carry their bags",
                    "B. To show staff professionalism and identity",
                    "C. To clean the car",
                    "D. To book the guest's ticket"
                ],
                answer: 1
            }
        ];

        // DOM Elements
        const participantSection = document.getElementById('participant-section');
        const quizContainer = document.getElementById('quiz-container');
        const questionContainer = document.getElementById('question-container');
        const progressBar = document.getElementById('progress-bar');
        const prevBtn = document.getElementById('prev-btn');
        const nextBtn = document.getElementById('next-btn');
        const submitBtn = document.getElementById('submit-btn');
        const startQuizBtn = document.getElementById('start-quiz');
        const thankYouSection = document.getElementById('thank-you');
        const menuBtn = document.getElementById('menu-btn');

        // Quiz state
        let currentQuestion = 0;
        let answers = new Array(questions.length).fill(null);
        let participantName = '';

        // Initialize the quiz
        function initQuiz() {
            participantName = document.getElementById('participant').value;
            if (!participantName) {
                alert('Please select your name before starting the quiz.');
                return;
            }

            participantSection.style.display = 'none';
            quizContainer.style.display = 'block';
            renderQuestion();
            updateProgressBar();
        }

        // Render the current question
        function renderQuestion() {
            questionContainer.innerHTML = '';
            
            const questionSlide = document.createElement('div');
            questionSlide.className = 'question-slide active';
            
            const questionNumber = document.createElement('div');
            questionNumber.className = 'question-number';
            questionNumber.textContent = `Question ${currentQuestion + 1} of ${questions.length}`;
            
            const questionText = document.createElement('div');
            questionText.className = 'question-text';
            questionText.textContent = questions[currentQuestion].question;
            
            const optionsDiv = document.createElement('div');
            optionsDiv.className = 'options';
            
            questions[currentQuestion].options.forEach((option, index) => {
                const optionElement = document.createElement('div');
                optionElement.className = 'option';
                if (answers[currentQuestion] === index) {
                    optionElement.classList.add('selected');
                }
                optionElement.textContent = option;
                optionElement.addEventListener('click', () => selectOption(index));
                optionsDiv.appendChild(optionElement);
            });
            
            questionSlide.appendChild(questionNumber);
            questionSlide.appendChild(questionText);
            questionSlide.appendChild(optionsDiv);
            questionContainer.appendChild(questionSlide);
            
            // Update navigation buttons
            prevBtn.disabled = currentQuestion === 0;
            nextBtn.style.display = currentQuestion === questions.length - 1 ? 'none' : 'block';
            submitBtn.style.display = currentQuestion === questions.length - 1 ? 'block' : 'none';
        }

        // Select an option
        function selectOption(optionIndex) {
            answers[currentQuestion] = optionIndex;
            const options = document.querySelectorAll('.option');
            options.forEach((option, index) => {
                option.classList.remove('selected');
                if (index === optionIndex) {
                    option.classList.add('selected');
                }
            });
        }

        // Navigate to previous question
        function prevQuestion() {
            if (currentQuestion > 0) {
                currentQuestion--;
                renderQuestion();
                updateProgressBar();
            }
        }

        // Navigate to next question
        function nextQuestion() {
            if (currentQuestion < questions.length - 1) {
                currentQuestion++;
                renderQuestion();
                updateProgressBar();
            }
        }

        // Update progress bar
        function updateProgressBar() {
            const progress = ((currentQuestion + 1) / questions.length) * 100;
            progressBar.style.width = `${progress}%`;
        }

        // Calculate score
        function calculateScore() {
            let score = 0;
            answers.forEach((answer, index) => {
                if (answer === questions[index].answer) {
                    score += 5;
                }
            });
            return score;
        }

        // Submit quiz
        async function submitQuiz() {
            const score = calculateScore();
            
            // Prepare data to send to Google Sheets
            const formData = {
                participant: participantName,
                answers: answers.join(','),
                score: score,
                timestamp: new Date().toISOString()
            };
            
            try {
                // Send data to Google Sheets
                await sendToGoogleSheets(formData);
                
                // Show thank you message
                quizContainer.style.display = 'none';
                thankYouSection.style.display = 'block';
            } catch (error) {
                console.error('Error submitting quiz:', error);
                alert('There was an error submitting your quiz. Please try again.');
            }
        }

        // Send data to Google Sheets
        async function sendToGoogleSheets(data) {
            // This URL should be replaced with your Google Apps Script web app URL
            const scriptUrl = 'https://script.google.com/macros/s/AKfycbzkKKL6K0tBxOFvgzuy2OOzo_WHISS4Fh5rHQOuofAnPGbHvbpzkhoS5KuZWJEEUBar/exec';
            
            try {
                const response = await fetch(scriptUrl, {
                    method: 'POST',
                    mode: 'no-cors',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify(data)
                });
                
                // Note: Due to no-cors mode, we can't read the response
                console.log('Data sent to Google Sheets');
            } catch (error) {
                console.error('Error sending data to Google Sheets:', error);
                throw error;
            }
        }

        // Event listeners
        startQuizBtn.addEventListener('click', initQuiz);
        prevBtn.addEventListener('click', prevQuestion);
        nextBtn.addEventListener('click', nextQuestion);
        submitBtn.addEventListener('click', submitQuiz);
        menuBtn.addEventListener('click', () => {
            window.location.href = 'menu_ujian_inggris.html';
        });
    </script>
</body>
</html>
